(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{"+Awk":function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var s=n("lwsE"),r=n.n(s),i=n("W8MJ"),o=n.n(i),a=n("rywy"),l=function(){function e(t){r()(this,e),this.uri=t}return o()(e,[{key:"list",value:function(e){return Object(a.a)({url:"/"+this.uri,method:"get",params:e})}},{key:"get",value:function(e){return Object(a.a)({url:"/"+this.uri+"/"+e,method:"get"})}},{key:"store",value:function(e){return Object(a.a)({url:"/"+this.uri,method:"post",data:e})}},{key:"update",value:function(e,t){return Object(a.a)({url:"/"+this.uri+"/"+e,method:"put",data:t})}},{key:"destroy",value:function(e){return Object(a.a)({url:"/"+this.uri+"/"+e,method:"delete"})}}]),e}()},"5ACI":function(e,t,n){"use strict";n("C0tNe")},"7W2i":function(e,t,n){var s=n("SksO");e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)},e.exports.__esModule=!0,e.exports.default=e.exports},"7sWw":function(e,t,n){var s=n("VyIk");"string"==typeof s&&(s=[[e.i,s,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n("aET+")(s,r);s.locals&&(e.exports=s.locals)},"9Bhp":function(e,t,n){"use strict";n.r(t);var s=n("yXPU"),r=n.n(s),i=n("o0o1"),o=n.n(i),a=n("+Awk"),l=n("lwsE"),c=n.n(l),u=n("W8MJ"),p=n.n(u),d=n("7W2i"),f=n.n(d),m=n("a1gu"),h=n.n(m),v=n("Nsbk"),b=n.n(v),y=n("rywy");function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,s=b()(e);if(t){var r=b()(this).constructor;n=Reflect.construct(s,arguments,r)}else n=s.apply(this,arguments);return h()(this,n)}}var w=function(e){f()(n,e);var t=g(n);function n(){return c()(this,n),t.call(this,"roles")}return p()(n,[{key:"permissions",value:function(e){return Object(y.a)({url:"/"+this.uri+"/"+e+"/permissions",method:"get"})}}]),n}(a.a),x=n("HF+U"),k=n("GczY"),P=n("OuqF"),_=new w,O=new a.a("permissions"),E={name:"RoleList",directives:{waves:x.a,permission:k.a},data:function(){return{currentRoleId:1,list:[],loading:!0,dialogLoading:!1,dialogVisible:!1,permissions:[],menuPermissions:[],otherPermissions:[],permissionProps:{children:"children",label:"name",disabled:"disabled"}}},computed:{currentRole:function(){var e=this,t=this.list.find((function(t){return t.id===e.currentRoleId}));return void 0===t?{name:"",permissions:[]}:t},rolePermissions:function(){return this.classifyPermissions(this.currentRole.permissions).all},roleMenuPermissions:function(){return this.classifyPermissions(this.currentRole.permissions).menu},roleOtherPermissions:function(){return this.classifyPermissions(this.currentRole.permissions).other}},created:function(){this.getRoles(),this.getPermissions()},methods:{checkPermission:P.a,getRoles:function(){var e=this;return r()(o.a.mark((function t(){var n,s;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,_.list({});case 3:n=t.sent,s=n.data,e.list=s,e.list.forEach((function(t,n){t.index=n+1,t.description=e.$t("roles.description."+t.name)})),e.loading=!1;case 8:case"end":return t.stop()}}),t)})))()},getPermissions:function(){var e=this;return r()(o.a.mark((function t(){var n,s,r,i,a,l;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O.list({});case 2:n=t.sent,s=n.data,r=e.classifyPermissions(s),i=r.all,a=r.menu,l=r.other,e.permissions=i,e.menuPermissions=a,e.otherPermissions=l,console.log(e.menuPermissions);case 9:case"end":return t.stop()}}),t)})))()},classifyPermissions:function(e){var t=this,n=[],s=[],r=[];return e.forEach((function(e){var i=e.name;n.push(e),i.startsWith("view menu")?s.push(t.normalizeMenuPermission(e)):r.push(t.normalizePermission(e))})),{all:n,menu:s,other:r}},normalizeMenuPermission:function(e){return{id:e.id,name:this.$options.filters.uppercaseFirst(e.name.substring(10))}},normalizePermission:function(e){return{id:e.id,name:this.$options.filters.uppercaseFirst(e.name),disabled:"manage permission"===e.name}},permissionKeys:function(e){return e.map((function(e){return e.id}))},handleEditPermissions:function(e){var t=this;this.dialogVisible=!0,this.currentRoleId=e,this.$nextTick((function(){t.$refs.menuPermissions.setCheckedKeys(t.permissionKeys(t.roleMenuPermissions)),t.$refs.otherPermissions.setCheckedKeys(t.permissionKeys(t.roleOtherPermissions))}))},confirmPermission:function(){var e=this,t=this.$refs.menuPermissions.getCheckedKeys(),n=this.$refs.otherPermissions.getCheckedKeys(),s=t.concat(n);this.dialogLoading=!0,_.update(this.currentRole.id,{permissions:s}).then((function(t){e.$message({message:"Permissions has been updated successfully",type:"success",duration:5e3}),e.dialogLoading=!1,e.dialogVisible=!1,e.getRoles()}))}}},j=(n("5ACI"),n("KHd+")),C=Object(j.a)(E,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container"},[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.list,border:"",fit:"","highlight-current-row":""}},[n("el-table-column",{attrs:{align:"center",label:"ID",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.index))])]}}])}),e._v(" "),n("el-table-column",{attrs:{width:"150",align:"center",label:e.$t("table.name")},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(e._f("uppercaseFirst")(t.row.name)))])]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"left",label:e.$t("table.description")},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.description))])]}}])}),e._v(" "),e.checkPermission(["manage permission"])?n("el-table-column",{attrs:{align:"center",label:"Actions",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return["admin"!==t.row.name?n("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["manage permission"],expression:"['manage permission']"}],attrs:{type:"primary",size:"small",icon:"el-icon-edit"},on:{click:function(n){return e.handleEditPermissions(t.row.id)}}},[e._v("\n          "+e._s(e.$t("permission.editPermission"))+"\n        ")]):e._e()]}}],null,!1,1525188536)}):e._e()],1),e._v(" "),n("el-dialog",{attrs:{visible:e.dialogVisible,title:"Edit Permissions - "+e.currentRole.name},on:{"update:visible":function(t){e.dialogVisible=t}}},[n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.dialogLoading,expression:"dialogLoading"}],staticClass:"form-container"},[n("div",{staticClass:"permissions-container"},[n("div",{staticClass:"block"},[n("el-form",{attrs:{model:e.currentRole,"label-width":"80px","label-position":"top"}},[n("el-form-item",{attrs:{label:"Menus"}},[n("el-tree",{ref:"menuPermissions",staticClass:"permission-tree",attrs:{data:e.menuPermissions,"default-checked-keys":e.permissionKeys(e.roleMenuPermissions),props:e.permissionProps,"show-checkbox":"","node-key":"id"}})],1)],1)],1),e._v(" "),n("div",{staticClass:"block"},[n("el-form",{attrs:{model:e.currentRole,"label-width":"80px","label-position":"top"}},[n("el-form-item",{attrs:{label:"Permissions"}},[n("el-tree",{ref:"otherPermissions",staticClass:"permission-tree",attrs:{data:e.otherPermissions,"default-checked-keys":e.permissionKeys(e.roleOtherPermissions),props:e.permissionProps,"show-checkbox":"","node-key":"id"}})],1)],1)],1),e._v(" "),n("div",{staticClass:"clear-left"})]),e._v(" "),n("div",{staticStyle:{"text-align":"right"}},[n("el-button",{attrs:{type:"danger"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("\n          "+e._s(e.$t("permission.cancel"))+"\n        ")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:e.confirmPermission}},[e._v("\n          "+e._s(e.$t("permission.confirm"))+"\n        ")])],1)])])],1)}),[],!1,null,"d40f7a72",null);t.default=C.exports},C0tNe:function(e,t,n){var s=n("WeWq");"string"==typeof s&&(s=[[e.i,s,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n("aET+")(s,r);s.locals&&(e.exports=s.locals)},GczY:function(e,t,n){"use strict";var s=n("g6NE"),r={inserted:function(e,t,n){var r=t.value,i=s.a.getters&&s.a.getters.permissions;if(!(r&&r instanceof Array&&r.length>0))throw new Error("Permissions are required! Example: v-permission=\"['manage user','manage permission']\"");var o=r;i.some((function(e){return o.includes(e)}))||e.parentNode&&e.parentNode.removeChild(e)}},i=function(e){e.directive("permission",r)};window.Vue&&(window.permission=r,Vue.use(i)),r.install=i;t.a=r},"HF+U":function(e,t,n){"use strict";n("7sWw");var s="@@wavesContext";function r(e,t){function n(n){var s=Object.assign({},t.value),r=Object.assign({ele:e,type:"hit",color:"rgba(0, 0, 0, 0.15)"},s),i=r.ele;if(i){i.style.position="relative",i.style.overflow="hidden";var o=i.getBoundingClientRect(),a=i.querySelector(".waves-ripple");switch(a?a.className="waves-ripple":((a=document.createElement("span")).className="waves-ripple",a.style.height=a.style.width=Math.max(o.width,o.height)+"px",i.appendChild(a)),r.type){case"center":a.style.top=o.height/2-a.offsetHeight/2+"px",a.style.left=o.width/2-a.offsetWidth/2+"px";break;default:a.style.top=(n.pageY-o.top-a.offsetHeight/2-document.documentElement.scrollTop||document.body.scrollTop)+"px",a.style.left=(n.pageX-o.left-a.offsetWidth/2-document.documentElement.scrollLeft||document.body.scrollLeft)+"px"}return a.style.backgroundColor=r.color,a.className="waves-ripple z-active",!1}}return e[s]?e[s].removeHandle=n:e[s]={removeHandle:n},n}var i={bind:function(e,t){e.addEventListener("click",r(e,t),!1)},update:function(e,t){e.removeEventListener("click",e[s].removeHandle,!0),e.addEventListener("click",r(e,t),!1)},unbind:function(e){e.removeEventListener("click",e[s].removeHandle,!1),e[s]=null,delete e[s]}},o=function(e){e.directive("waves",i)};window.Vue&&(window.waves=i,Vue.use(o)),i.install=o;t.a=i},Nsbk:function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},e.exports.__esModule=!0,e.exports.default=e.exports,n(t)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports},OuqF:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var s=n("g6NE");function r(e){if(e&&e instanceof Array&&e.length>0){var t=s.a.getters&&s.a.getters.permissions,n=e;return t.some((function(e){return n.includes(e)}))}return console.error("Need permissions! Like v-permission=\"['manage permission','edit article']\""),!1}},PJYZ:function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.__esModule=!0,e.exports.default=e.exports},SksO:function(e,t){function n(t,s){return e.exports=n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},e.exports.__esModule=!0,e.exports.default=e.exports,n(t,s)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports},VyIk:function(e,t,n){(t=n("JPst")(!1)).push([e.i,".waves-ripple {\r\n    position: absolute;\r\n    border-radius: 100%;\r\n    background-color: rgba(0, 0, 0, 0.15);\r\n    background-clip: padding-box;\r\n    pointer-events: none;\r\n    -webkit-user-select: none;\r\n    -moz-user-select: none;\r\n    -ms-user-select: none;\r\n    user-select: none;\r\n    -webkit-transform: scale(0);\r\n    transform: scale(0);\r\n    opacity: 1;\r\n}\r\n\r\n.waves-ripple.z-active {\r\n    opacity: 0;\r\n    -webkit-transform: scale(2);\r\n    transform: scale(2);\r\n    -webkit-transition: opacity 1.2s ease-out, -webkit-transform 0.6s ease-out;\r\n    transition: opacity 1.2s ease-out, -webkit-transform 0.6s ease-out;\r\n    transition: opacity 1.2s ease-out, transform 0.6s ease-out;\r\n    transition: opacity 1.2s ease-out, transform 0.6s ease-out, -webkit-transform 0.6s ease-out;\r\n}",""]),e.exports=t},W8MJ:function(e,t,n){var s=n("o5UB");function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s(r.key),r)}}e.exports=function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports},WeWq:function(e,t,n){(t=n("JPst")(!1)).push([e.i,".permissions-container[data-v-d40f7a72] {\n  -webkit-box-flex: 1;\n      -ms-flex: 1;\n          flex: 1;\n  -webkit-box-pack: justify;\n      -ms-flex-pack: justify;\n          justify-content: space-between;\n  font-size: 14px;\n  padding-right: 8px;\n}\n.permissions-container .block[data-v-d40f7a72] {\n  float: left;\n  min-width: 250px;\n}\n.permissions-container .clear-left[data-v-d40f7a72] {\n  clear: left;\n}\n",""]),e.exports=t},a1gu:function(e,t,n){var s=n("cDf5").default,r=n("PJYZ");e.exports=function(e,t){if(t&&("object"===s(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return r(e)},e.exports.__esModule=!0,e.exports.default=e.exports},lwsE:function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports}}]);